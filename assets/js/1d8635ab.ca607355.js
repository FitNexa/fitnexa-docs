"use strict";(globalThis.webpackChunkfitnexa_docs=globalThis.webpackChunkfitnexa_docs||[]).push([[4115],{2201(e,n,t){t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"UAT_SETUP_GUIDE","title":"FitNexa UAT Environment Setup Guide","description":"This guide documents the setup of the User Acceptance Testing (UAT) environment on Hetzner Cloud and Vercel, automated via GitHub Actions.","source":"@site/docs/UAT_SETUP_GUIDE.md","sourceDirName":".","slug":"/UAT_SETUP_GUIDE","permalink":"/fitnexa-docs/docs/UAT_SETUP_GUIDE","draft":false,"unlisted":false,"editUrl":"https://github.com/FitNexa/fitnexa-platform/tree/main/fitnexa-docs/docs/UAT_SETUP_GUIDE.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"FitNexa System Overview","permalink":"/fitnexa-docs/docs/SYSTEM_OVERVIEW"},"next":{"title":"Adaptive Admin Portals","permalink":"/fitnexa-docs/docs/admin/ADAPTIVE_PORTALS"}}');var s=t(4848),l=t(8453);const r={},d="FitNexa UAT Environment Setup Guide",c={},o=[{value:"1. Architecture Overview",id:"1-architecture-overview",level:2},{value:"2. GitHub Secrets Configuration",id:"2-github-secrets-configuration",level:2},{value:"3. Deployment Workflows",id:"3-deployment-workflows",level:2},{value:"A. FitNexa Backend (<code>fitnexa-backend</code>)",id:"a-fitnexa-backend-fitnexa-backend",level:3},{value:"B. FitNexa Admin (<code>fitnexa-admin</code>)",id:"b-fitnexa-admin-fitnexa-admin",level:3},{value:"C. FitNexa Shared (<code>fitnexa-shared</code>)",id:"c-fitnexa-shared-fitnexa-shared",level:3},{value:"4. Testing &amp; Verification",id:"4-testing--verification",level:2},{value:"Easy Test Utility",id:"easy-test-utility",level:3},{value:"Manual Verification",id:"manual-verification",level:3},{value:"5. Troubleshooting",id:"5-troubleshooting",level:2}];function a(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"fitnexa-uat-environment-setup-guide",children:"FitNexa UAT Environment Setup Guide"})}),"\n",(0,s.jsx)(n.p,{children:"This guide documents the setup of the User Acceptance Testing (UAT) environment on Hetzner Cloud and Vercel, automated via GitHub Actions."}),"\n",(0,s.jsx)(n.h2,{id:"1-architecture-overview",children:"1. Architecture Overview"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Backend"}),": Hosted on Hetzner Cloud (VPS).","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["IP: ",(0,s.jsx)(n.code,{children:"89.167.47.120"})," (HTTPS Enabled)"]}),"\n",(0,s.jsx)(n.li,{children:"Services: Gateway, Identity, Gym, Nutrition, Content, Squad, Wizard, Messaging, Logging, Postgres (Dockerized)."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Frontend"}),": Hosted on Vercel.","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Gym Admin: ",(0,s.jsx)(n.code,{children:"fitnexa-gym-admin-uat.vercel.app"})]}),"\n",(0,s.jsxs)(n.li,{children:["Super Admin: ",(0,s.jsx)(n.code,{children:"fitnexa-super-admin-uat.vercel.app"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"CI/CD"}),": GitHub Actions deploys automatically on push to ",(0,s.jsx)(n.code,{children:"main"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"2-github-secrets-configuration",children:"2. GitHub Secrets Configuration"}),"\n",(0,s.jsxs)(n.p,{children:["Since you are on a ",(0,s.jsx)(n.strong,{children:"Free GitHub Organization Plan"}),', you cannot use "Organization Secrets" for private repos. You must add the following secrets to ',(0,s.jsx)(n.strong,{children:"EACH"})," repository (",(0,s.jsx)(n.code,{children:"fitnexa-backend"}),", ",(0,s.jsx)(n.code,{children:"fitnexa-admin"}),", ",(0,s.jsx)(n.code,{children:"fitnexa-shared"}),"):"]}),"\n",(0,s.jsxs)(n.p,{children:["Go to: ",(0,s.jsx)(n.code,{children:"Settings"})," -> ",(0,s.jsx)(n.code,{children:"Secrets and variables"})," -> ",(0,s.jsx)(n.code,{children:"Actions"})," -> ",(0,s.jsx)(n.code,{children:"New repository secret"})]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Secret Name"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Value"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"SSH_HOST"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"89.167.47.120"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"IP of the UAT VPS"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"SSH_PRIVATE_KEY"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.em,{children:"(Paste your github-actions-key)"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Private SSH key for deployments"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"VERCEL_TOKEN"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.em,{children:"(User Generated)"})}),(0,s.jsxs)(n.td,{style:{textAlign:"left"},children:["Create at ",(0,s.jsx)(n.a,{href:"https://vercel.com/account/tokens",children:"vercel.com/account/tokens"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"VERCEL_ORG_ID"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"team_yO1PspykK1To83i2YnJSTw4X"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Vercel Team ID"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"VERCEL_PROJECT_ID_GYM"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"prj_47X009Ji7AgAVG4jfIBjbsWxEgjQ"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Gym Admin Project ID"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"VERCEL_PROJECT_ID_SUPER"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"prj_lYJ4y5YKrTn39bY3tqWECHgzXPpi"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Super Admin Project ID"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"GH_PAT"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.em,{children:"(User Generated)"})}),(0,s.jsxs)(n.td,{style:{textAlign:"left"},children:["Personal Access Token with ",(0,s.jsx)(n.code,{children:"repo"})," scope"]})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"3-deployment-workflows",children:"3. Deployment Workflows"}),"\n",(0,s.jsx)(n.p,{children:"We have separated workflows for each repository. Ensure these files exist in your repos:"}),"\n",(0,s.jsxs)(n.h3,{id:"a-fitnexa-backend-fitnexa-backend",children:["A. FitNexa Backend (",(0,s.jsx)(n.code,{children:"fitnexa-backend"}),")"]}),"\n",(0,s.jsxs)(n.p,{children:["File: ",(0,s.jsx)(n.code,{children:".github/workflows/deploy-backend.yml"})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Checkouts ",(0,s.jsx)(n.code,{children:"fitnexa-backend"})," and ",(0,s.jsx)(n.code,{children:"fitnexa-shared"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"Archives code and copies to VPS."}),"\n",(0,s.jsx)(n.li,{children:"Runs deployment script via SSH."}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"b-fitnexa-admin-fitnexa-admin",children:["B. FitNexa Admin (",(0,s.jsx)(n.code,{children:"fitnexa-admin"}),")"]}),"\n",(0,s.jsxs)(n.p,{children:["Workflows in ",(0,s.jsx)(n.code,{children:".github/workflows/"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"deploy-gym-admin.yml"}),": Deploys Gym Admin to Vercel."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"deploy-super-admin.yml"}),": Deploys Super Admin to Vercel."]}),"\n",(0,s.jsxs)(n.li,{children:["Each checks out ",(0,s.jsx)(n.code,{children:"fitnexa-admin"})," (and ",(0,s.jsx)(n.code,{children:"fitnexa-shared"})," if needed), uses Vercel CLI and tokens to deploy the corresponding project."]}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"c-fitnexa-shared-fitnexa-shared",children:["C. FitNexa Shared (",(0,s.jsx)(n.code,{children:"fitnexa-shared"}),")"]}),"\n",(0,s.jsxs)(n.p,{children:["File: ",(0,s.jsx)(n.code,{children:".github/workflows/shared-ci.yml"})," (or equivalent)"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Runs tests/checks to ensure shared library integrity."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"4-testing--verification",children:"4. Testing & Verification"}),"\n",(0,s.jsx)(n.p,{children:"We've implemented a unified testing utility to make it easy to verify both Local and UAT environments."}),"\n",(0,s.jsx)(n.h3,{id:"easy-test-utility",children:"Easy Test Utility"}),"\n",(0,s.jsx)(n.p,{children:"Run the following command in the project root:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm run easy-test\n"})}),"\n",(0,s.jsx)(n.p,{children:"This interactive script allows you to:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Select Environment"}),": Local (localhost) or UAT (",(0,s.jsx)(n.a,{href:"https://89.167.47.120",children:"https://89.167.47.120"}),")."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Select Test Mode"}),": Standard Run (plain ",(0,s.jsx)(n.code,{children:"npm test"})," per service) or Coverage Report (",(0,s.jsx)(n.code,{children:"npm test -- --coverage"}),")."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Run"}),": Executes the test script for each backend service that has one (gateway, identity, gym, content, squad, nutrition, wizard, messaging, logging). Use this to verify unit tests locally or against UAT. For health checks and integration tests, use ",(0,s.jsx)(n.code,{children:"npm run health-check"})," and ",(0,s.jsx)(n.code,{children:"npm run test:integration"})," as needed."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"manual-verification",children:"Manual Verification"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Backend Health Check"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["URL: ",(0,s.jsx)(n.code,{children:"https://89.167.47.120/health"})," (or root)"]}),"\n",(0,s.jsxs)(n.li,{children:["Check Docker: ",(0,s.jsx)(n.code,{children:'ssh root@89.167.47.120 "docker ps"'})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Frontend Access"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Gym Admin: ",(0,s.jsx)(n.a,{href:"https://fitnexa-gym-admin-uat.vercel.app",children:"https://fitnexa-gym-admin-uat.vercel.app"})]}),"\n",(0,s.jsxs)(n.li,{children:["Super Admin: ",(0,s.jsx)(n.a,{href:"https://fitnexa-super-admin-uat.vercel.app",children:"https://fitnexa-super-admin-uat.vercel.app"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"5-troubleshooting",children:"5. Troubleshooting"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:'"Permission Denied (publickey)"'}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Check ",(0,s.jsx)(n.code,{children:"SSH_PRIVATE_KEY"})," in GitHub Secrets."]}),"\n",(0,s.jsxs)(n.li,{children:["Ensure public key is in ",(0,s.jsx)(n.code,{children:"~/.ssh/authorized_keys"})," on VPS."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:'"Vercel Deployment Failed"'}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Check ",(0,s.jsx)(n.code,{children:"VERCEL_TOKEN"})," validity."]}),"\n",(0,s.jsx)(n.li,{children:"Ensure Project IDs match the Vercel project settings."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},8453(e,n,t){t.d(n,{R:()=>r,x:()=>d});var i=t(6540);const s={},l=i.createContext(s);function r(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);