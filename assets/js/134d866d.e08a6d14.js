"use strict";(globalThis.webpackChunkfitnexa_docs=globalThis.webpackChunkfitnexa_docs||[]).push([[8699],{8465(e,i,n){n.r(i),n.d(i,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"infrastructure/uat-setup","title":"UAT Setup","description":"Guidelines for setting up a User Acceptance Testing environment","source":"@site/docs/infrastructure/uat-setup.md","sourceDirName":"infrastructure","slug":"/infrastructure/uat-setup","permalink":"/docs/infrastructure/uat-setup","draft":false,"unlisted":false,"editUrl":"https://github.com/FitNexa/fitnexa-platform/tree/main/fitnexa-docs/docs/infrastructure/uat-setup.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"UAT Setup","description":"Guidelines for setting up a User Acceptance Testing environment"},"sidebar":"tutorialSidebar","previous":{"title":"Single Domain Vercel","permalink":"/docs/infrastructure/single-domain-vercel"},"next":{"title":"Contributing","permalink":"/docs/dev-workflows/contributing"}}');var d=n(4848),s=n(8453);const t={sidebar_position:3,title:"UAT Setup",description:"Guidelines for setting up a User Acceptance Testing environment"},l="UAT Setup Guide",c={},o=[{value:"Infrastructure",id:"infrastructure",level:2},{value:"Domain Mapping",id:"domain-mapping",level:2},{value:"Backend Deployment",id:"backend-deployment",level:2},{value:"Deploy Script",id:"deploy-script",level:3},{value:"CI/CD Workflow",id:"cicd-workflow",level:3},{value:"Required GitHub Secrets",id:"required-github-secrets",level:3},{value:"Mobile App Builds",id:"mobile-app-builds",level:2},{value:"Build Flow",id:"build-flow",level:3},{value:"Required Environment Variables (wizard-service)",id:"required-environment-variables-wizard-service",level:3},{value:"Frontend Deployment",id:"frontend-deployment",level:2}];function a(e){const i={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(i.header,{children:(0,d.jsx)(i.h1,{id:"uat-setup-guide",children:"UAT Setup Guide"})}),"\n",(0,d.jsx)(i.p,{children:"This guide outlines the process for deploying and configuring a UAT environment for FitNexa."}),"\n",(0,d.jsx)(i.h2,{id:"infrastructure",children:"Infrastructure"}),"\n",(0,d.jsxs)(i.table,{children:[(0,d.jsx)(i.thead,{children:(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.th,{children:"Component"}),(0,d.jsx)(i.th,{children:"Hosting"}),(0,d.jsx)(i.th,{children:"Purpose"})]})}),(0,d.jsxs)(i.tbody,{children:[(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"Landing Page"}),(0,d.jsx)(i.td,{children:"Vercel"}),(0,d.jsx)(i.td,{children:"Marketing site at gymia.fit"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"Onboarding App"}),(0,d.jsx)(i.td,{children:"Vercel"}),(0,d.jsx)(i.td,{children:"Self-service wizard at onboarding.uat.gymia.fit"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"Gym Admin"}),(0,d.jsx)(i.td,{children:"Vercel"}),(0,d.jsx)(i.td,{children:"Chameleon admin at admin.uat.gymia.fit"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"Super Admin"}),(0,d.jsx)(i.td,{children:"Vercel"}),(0,d.jsx)(i.td,{children:"Platform management"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"Backend Services"}),(0,d.jsx)(i.td,{children:"VPS (Docker Compose)"}),(0,d.jsx)(i.td,{children:"Microservices at api.uat.gymia.fit"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"PostgreSQL"}),(0,d.jsx)(i.td,{children:"Managed (Supabase / VPS)"}),(0,d.jsx)(i.td,{children:"Primary database"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"Redis"}),(0,d.jsx)(i.td,{children:"VPS"}),(0,d.jsx)(i.td,{children:"Caching layer"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"RabbitMQ"}),(0,d.jsx)(i.td,{children:"VPS"}),(0,d.jsx)(i.td,{children:"Async messaging"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"MongoDB"}),(0,d.jsx)(i.td,{children:"VPS"}),(0,d.jsx)(i.td,{children:"Log storage"})]})]})]}),"\n",(0,d.jsx)(i.h2,{id:"domain-mapping",children:"Domain Mapping"}),"\n",(0,d.jsxs)(i.p,{children:["UAT uses the following subdomains under ",(0,d.jsx)(i.code,{children:"gymia.fit"}),":"]}),"\n",(0,d.jsxs)(i.ul,{children:["\n",(0,d.jsxs)(i.li,{children:[(0,d.jsx)(i.code,{children:"gymia.fit"})," - Landing page"]}),"\n",(0,d.jsxs)(i.li,{children:[(0,d.jsx)(i.code,{children:"onboarding.uat.gymia.fit"})," - Onboarding wizard"]}),"\n",(0,d.jsxs)(i.li,{children:[(0,d.jsx)(i.code,{children:"admin.uat.gymia.fit"})," - Gym admin portal"]}),"\n",(0,d.jsxs)(i.li,{children:[(0,d.jsx)(i.code,{children:"api.uat.gymia.fit"})," - API gateway"]}),"\n"]}),"\n",(0,d.jsx)(i.h2,{id:"backend-deployment",children:"Backend Deployment"}),"\n",(0,d.jsxs)(i.p,{children:["Backend services are deployed to the VPS via GitHub Actions using the ",(0,d.jsx)(i.code,{children:"deploy-backend.yml"})," workflow."]}),"\n",(0,d.jsx)(i.h3,{id:"deploy-script",children:"Deploy Script"}),"\n",(0,d.jsxs)(i.p,{children:["The ",(0,d.jsx)(i.code,{children:"scripts/deploy-uat.sh"})," script runs on the VPS and performs the following:"]}),"\n",(0,d.jsxs)(i.ol,{children:["\n",(0,d.jsxs)(i.li,{children:["Verifies that ",(0,d.jsx)(i.code,{children:"docker-compose.uat.deploy.yml"})," exists in ",(0,d.jsx)(i.code,{children:"fitnexa-backend/"})]}),"\n",(0,d.jsxs)(i.li,{children:["Checks for ",(0,d.jsx)(i.code,{children:".env.uat"})," in ",(0,d.jsx)(i.code,{children:"fitnexa-backend/"})," (warns if missing)"]}),"\n",(0,d.jsxs)(i.li,{children:["Runs ",(0,d.jsx)(i.code,{children:"docker compose up -d --build --remove-orphans"})]}),"\n",(0,d.jsx)(i.li,{children:"Displays container status after deployment"}),"\n"]}),"\n",(0,d.jsx)(i.h3,{id:"cicd-workflow",children:"CI/CD Workflow"}),"\n",(0,d.jsxs)(i.p,{children:["The ",(0,d.jsx)(i.code,{children:"deploy-backend.yml"})," GitHub Actions workflow:"]}),"\n",(0,d.jsxs)(i.ol,{children:["\n",(0,d.jsxs)(i.li,{children:["Checks out the repository with ",(0,d.jsx)(i.code,{children:"submodules: recursive"})]}),"\n",(0,d.jsxs)(i.li,{children:["Archives source code into a tarball (includes ",(0,d.jsx)(i.code,{children:"fitnexa-backend"}),", ",(0,d.jsx)(i.code,{children:"fitnexa-shared"}),", ",(0,d.jsx)(i.code,{children:"fitnexa-admin"}),", and ",(0,d.jsx)(i.code,{children:"scripts"})," directories)"]}),"\n",(0,d.jsx)(i.li,{children:"Copies the archive to the VPS via SCP"}),"\n",(0,d.jsx)(i.li,{children:"Extracts the archive on the VPS"}),"\n",(0,d.jsxs)(i.li,{children:["Runs ",(0,d.jsx)(i.code,{children:"scripts/deploy-uat.sh"})]}),"\n"]}),"\n",(0,d.jsx)(i.h3,{id:"required-github-secrets",children:"Required GitHub Secrets"}),"\n",(0,d.jsxs)(i.table,{children:[(0,d.jsx)(i.thead,{children:(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.th,{children:"Secret"}),(0,d.jsx)(i.th,{children:"Description"})]})}),(0,d.jsxs)(i.tbody,{children:[(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:(0,d.jsx)(i.code,{children:"VPS_HOST"})}),(0,d.jsx)(i.td,{children:"VPS IP address or hostname"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:(0,d.jsx)(i.code,{children:"VPS_USER"})}),(0,d.jsx)(i.td,{children:"SSH username"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:(0,d.jsx)(i.code,{children:"VPS_SSH_KEY"})}),(0,d.jsx)(i.td,{children:"SSH private key for deployment"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:(0,d.jsx)(i.code,{children:"VPS_PATH"})}),(0,d.jsx)(i.td,{children:"Deployment directory on VPS"})]})]})]}),"\n",(0,d.jsx)(i.h2,{id:"mobile-app-builds",children:"Mobile App Builds"}),"\n",(0,d.jsxs)(i.p,{children:["UAT APK builds are triggered from the gym admin dashboard and run via GitHub Actions in the ",(0,d.jsx)(i.code,{children:"fitnexa-mobile"})," repository."]}),"\n",(0,d.jsx)(i.h3,{id:"build-flow",children:"Build Flow"}),"\n",(0,d.jsxs)(i.ol,{children:["\n",(0,d.jsx)(i.li,{children:'Gym admin clicks "Request UAT Build" in the dashboard'}),"\n",(0,d.jsxs)(i.li,{children:["Wizard-service triggers ",(0,d.jsx)(i.code,{children:"repository_dispatch"})," event via GitHub API"]}),"\n",(0,d.jsxs)(i.li,{children:[(0,d.jsx)(i.code,{children:"uat-build.yml"})," workflow builds a branded APK"]}),"\n",(0,d.jsxs)(i.li,{children:["Workflow calls back to ",(0,d.jsx)(i.code,{children:"POST /wizard/webhooks/build-complete"})]}),"\n",(0,d.jsx)(i.li,{children:"Admin downloads the APK from the dashboard"}),"\n"]}),"\n",(0,d.jsx)(i.h3,{id:"required-environment-variables-wizard-service",children:"Required Environment Variables (wizard-service)"}),"\n",(0,d.jsxs)(i.table,{children:[(0,d.jsx)(i.thead,{children:(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.th,{children:"Variable"}),(0,d.jsx)(i.th,{children:"Description"})]})}),(0,d.jsxs)(i.tbody,{children:[(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:(0,d.jsx)(i.code,{children:"GITHUB_TOKEN"})}),(0,d.jsx)(i.td,{children:"PAT with repo scope for triggering builds"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:(0,d.jsx)(i.code,{children:"GITHUB_REPO_OWNER"})}),(0,d.jsx)(i.td,{children:"GitHub org (default: FitNexa)"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:(0,d.jsx)(i.code,{children:"GITHUB_REPO_NAME"})}),(0,d.jsx)(i.td,{children:"Mobile repo (default: fitnexa-mobile)"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:(0,d.jsx)(i.code,{children:"SMTP_PASS"})}),(0,d.jsx)(i.td,{children:"SMTP password for sending activation emails"})]})]})]}),"\n",(0,d.jsx)(i.h2,{id:"frontend-deployment",children:"Frontend Deployment"}),"\n",(0,d.jsxs)(i.p,{children:["Frontend applications are deployed to Vercel automatically on push to the ",(0,d.jsx)(i.code,{children:"main"})," branch. Each app has its own Vercel project connected to the corresponding subdirectory."]}),"\n",(0,d.jsx)(i.hr,{}),"\n",(0,d.jsxs)(i.p,{children:["Related: ",(0,d.jsx)(i.a,{href:"/docs/infrastructure/single-domain-vercel",children:"Single Domain Vercel"})," | ",(0,d.jsx)(i.a,{href:"/docs/dev-workflows/environment-setup",children:"Environment Variables"})," | ",(0,d.jsx)(i.a,{href:"/docs/features/gym-onboarding-flow",children:"Gym Onboarding Flow"})]})]})}function h(e={}){const{wrapper:i}={...(0,s.R)(),...e.components};return i?(0,d.jsx)(i,{...e,children:(0,d.jsx)(a,{...e})}):a(e)}},8453(e,i,n){n.d(i,{R:()=>t,x:()=>l});var r=n(6540);const d={},s=r.createContext(d);function t(e){const i=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function l(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:t(e.components),r.createElement(s.Provider,{value:i},e.children)}}}]);